<html>
  <head>
    <script src='http://www.google.com/jsapi'></script>
    <link href='http://fonts.googleapis.com/css?family=Quattrocento+Sans:400,700' rel='stylesheet' type='text/css'>
    <meta charset="utf-8" />
    <link href="style.css" rel="stylesheet" />
    <title>Octomaps: <%= @repo.owner %>/<%= @repo.name %></title>
  </head>
  <body>

  <div id = "left">
    <header>
      <h1>Great success!</h1>
      <% if params[:submit1] %>
        <h2><strong><%= @repo.locations.size %></strong> contributors in<br>
            <strong><%= @repo.location_count.size %></strong> locations for<br>
            <strong><%= @repo.owner %>/<%= @repo.name %></strong></h2>
      <% elsif params[:submit2] %>
        <h2><strong><%= @repo.country_locations.size %></strong> contributors in<br>
            <strong><%= @repo.location_count.size %></strong> countries for<br>
            <strong><%= @repo.owner %>/<%= @repo.name %></strong></h2>
      <% end %>
      <div id = "twitter">
      <a href="https://twitter.com/share" class="twitter-share-button">Tweet</a>
      <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    </div>
    </header>

    <div id = "table">
      <ul>
        <% list = @repo.location_count.sort_by{|location, contributors| contributors}.reverse %>
        <% list.each do |location, count| %>
          <li><%= "#{count}" %> in <%= "#{location}" %></li>
        <% end %>
      </ul>
    </div>

    <div id = "query_form">
      <form action="/map" method="get">
        <p>Enter a GitHub repository owner and name to generate another map.</p>
        Repository Owner: <input type="text" name="owner">
        Repository Name:<br> <input type="text" name="repo"><br>
        <input type="submit" value="Map by City*" id="submit" name ="submit1">
        <input type="submit" value="Map by Country" id="submit" name ="submit2">
      </form>
      <footer>* Please note that this option maps contributors by the location they have specified on their GitHub  account, which is not standardized.
      </footer>
    </div>

    <div id = "credits">
      <ul>
          <li>Created by:</li>
          <li><a href = "http://www.twitter.com/johnkferguson">John Kelly Ferguson</a>, <a href = "http://www.twitter.com/mrikhter">Masha Rikhter</a> & <a href = "http://www.twitter.com/jkestler">Justin Kestler</a></li>
          <li>Students at the <a href = "http://www.flatironschool.com">Flatiron School</a>.</li>
      </ul>
    </div>

  </div>
  <div id='chart_markers'>
    <%= @chart_markers.to_js("chart_markers") %>
  </div>

  </body>
  <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-38965200-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</html>